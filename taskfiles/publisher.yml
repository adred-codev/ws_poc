version: '3'

# Publisher control tasks

tasks:
  start:
    desc: Start publishing messages (override with RATE=10)
    vars:
      RATE: '{{.RATE | default "10"}}'
    cmds:
      - |
        curl -X POST http://localhost:3003/control \
          -H "Content-Type: application/json" \
          -d '{"action":"start","messagesPerSecond":{{.RATE}}}' | jq '.'

  stop:
    desc: Stop publishing messages
    cmds:
      - |
        curl -X POST http://localhost:3003/control \
          -H "Content-Type: application/json" \
          -d '{"action":"stop"}' | jq '.'

  configure:
    desc: Configure publisher (override with RATE=10)
    vars:
      RATE: '{{.RATE | default "10"}}'
    cmds:
      - |
        curl -X POST http://localhost:3003/control \
          -H "Content-Type: application/json" \
          -d '{"action":"configure","messagesPerSecond":{{.RATE}}}' | jq '.'
