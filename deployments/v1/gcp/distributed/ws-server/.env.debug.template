# =============================================================================
# DEBUG MODE TEMPLATE
# =============================================================================
# Purpose: Single-shard debug configuration for investigating handshake failures
# Usage:
#   1. Enable debug mode:  cp .env.debug.template .env.debug
#   2. Deploy:             docker-compose -f docker-compose.multi.yml up -d --force-recreate
#   3. Disable debug mode: rm .env.debug && docker-compose -f docker-compose.multi.yml up -d
#
# Load Priority: This file loads LAST, overriding all other env files
# Load Order: base.env → kafka-topics.env → ports.env → overrides.multi.env → .env.production → .env.debug
#
# WARNING: .env.debug is gitignored. Its presence = debug mode active.
#          Delete this file to return to production (3-shard) configuration.
# =============================================================================

# =============================================================================
# SHARD CONFIGURATION (Single-Shard Debug Mode)
# =============================================================================
# Run with ONLY 1 shard for easier debugging and log analysis
# Production uses NUM_SHARDS=3 (from overrides.multi.env)
NUM_SHARDS=1

# Use different ports to avoid conflicts with existing deployments
# Production uses 3002-3004 for shards, 3001 for LoadBalancer
SHARD_BASE_PORT=8080      # Single shard on port 8080
LB_PORT=8081              # LoadBalancer on port 8081
LB_ADDR=:8081

# =============================================================================
# RESOURCE LIMITS (Single-Shard Debug)
# =============================================================================
# Reduced limits appropriate for single shard
WS_MAX_CONNECTIONS=6000   # Single shard capacity (vs 18K for 3 shards)
WS_MAX_GOROUTINES=15000   # Reduced goroutine limit for 1 shard

# =============================================================================
# LOGGING (Verbose Debug Mode)
# =============================================================================
# Enable detailed logging for debugging
# Uncomment to enable verbose logging:
# LOG_LEVEL=debug
# WS_DEBUG=true

# =============================================================================
# RATE LIMITING (Debug - Same as Production)
# =============================================================================
# Keep same rate limits for realistic testing
# WS_MAX_KAFKA_RATE=25
# WS_MAX_BROADCAST_RATE=25

# =============================================================================
# NOTES
# =============================================================================
# After creating .env.debug, verify configuration:
#   docker exec odin-ws-multi env | grep -E "NUM_SHARDS|SHARD_BASE_PORT|LB_ADDR"
#
# Check if debug mode is active:
#   ls -la .env.debug 2>/dev/null && echo "DEBUG MODE" || echo "PRODUCTION MODE"
#
# Monitor single-shard logs:
#   docker logs -f odin-ws-multi --tail 100
