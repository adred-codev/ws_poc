# =============================================================================
# GCP Production Overrides
# =============================================================================
# Purpose: Override shared/base.env for GCP production deployment
# Load order: base.env → kafka-topics.env → ports.env → overrides.env → .env.production
# Instance: e2-standard-4 (4 vCPU, 16GB RAM)
# Target: 12,000 connections @ 1 core

ENVIRONMENT=production

# =============================================================================
# KAFKA CONNECTION
# =============================================================================
# Note: KAFKA_BROKERS is set in .env.production (generated by deployment script)
# This file only overrides the consumer group ID
KAFKA_GROUP_ID=ws-server-production

# =============================================================================
# RESOURCE LIMITS (Production e2-standard-4)
# =============================================================================
# Strategy: Maximize RAM, minimize CPU (1 core avoids scheduler overhead)
# Target: 12K connections @ ~30% CPU, ~46% memory
WS_CPU_LIMIT=1
WS_MEMORY_LIMIT=15569256448  # 14.5 GB (90% of 16GB)
WS_MAX_CONNECTIONS=12000

# =============================================================================
# WORKER POOL (Production-validated for 12K connections)
# =============================================================================
WS_WORKER_POOL_SIZE=256  # Override: Production validated
WS_WORKER_QUEUE_SIZE=25600  # Override: Production validated

# =============================================================================
# RATE LIMITING (Production-validated)
# =============================================================================
WS_MAX_KAFKA_RATE=25  # Override: Based on 40K tx/day peak metrics

# =============================================================================
# GOROUTINE LIMIT (Calculated for production capacity)
# =============================================================================
# Formula: ((12,000 × 2) + 256 + 13) × 1.2 = 29,122 → 30,000
WS_MAX_GOROUTINES=30000
